<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Mahdi Tavakol — C++ • Python • Software Engineering Portfolio</title>
<meta name="description" content="Modern C • C++ • CUDA • RAII • Parallelism • Numerical Algorithms • Linux Toolchains • Data Science. Portfolio of Mahdi Tavakol with CVs, slides, GitHub, Kaggle." />
<style>
  :root{
    --bg:#0a0b10; --text:#e8ecf2; --muted:#a9b4c2; --border:#222634;
    --panel:#10121a; --card:#121624; --link:#8ab4ff;

    /* Showcase tuning */
    --peek: 8vw;            /* how much neighbors peek */
    --center-scale: 1.35;   /* focused card size */
    --side-scale: 0.86;     /* neighbor size */
    --snap-gap: 16px;
  }

  *{box-sizing:border-box;}
  html,body{margin:0;padding:0;background:var(--bg);color:var(--text);font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Ubuntu;}
  html{scroll-behavior:smooth;}

  /* Nav */
  header{
    position:sticky;top:0;z-index:10;
    backdrop-filter:blur(8px);
    background:linear-gradient(to bottom,rgba(0,0,0,.5),rgba(0,0,0,.2));
    border-bottom:1px solid var(--border);
  }
  .nav{display:flex;align-items:center;gap:12px;max-width:1200px;margin:0 auto;padding:10px 16px;}
  .brand{font-weight:800;border:1px solid var(--border);border-radius:999px;padding:6px 10px;color:var(--muted);}
  .spacer{flex:1;}
  .nav a{color:var(--muted);text-decoration:none;font-weight:600;padding:8px 10px;border-radius:8px;}
  .nav a:hover{color:var(--text);background:rgba(255,255,255,.06);}

  /* HERO */
  .hero{position:relative;height:100svh;overflow:hidden;border-bottom:1px solid var(--border);scroll-snap-align:start;scroll-snap-stop:always;}
  .hero .media-layer{position:absolute;inset:0;overflow:hidden;}
  .hero video,
  .hero iframe{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;}
  .hero video{filter:brightness(.55) contrast(1.05) saturate(1.08);}
  .hero iframe{pointer-events:none;border:0;}
  .overlay{position:absolute;inset:0;background:
      radial-gradient(1200px 600px at 10% 20%, rgba(59,130,246,.35), transparent 60%),
      radial-gradient(1000px 600px at 80% 10%, rgba(167,139,250,.35), transparent 60%),
      linear-gradient(to bottom, rgba(0,0,0,.25), rgba(0,0,0,.55) 60%, rgba(0,0,0,.85));}
  .hero-inner{position:relative;z-index:2;height:100%;display:grid;place-items:center;text-align:center;padding:0 16px;}
  .title{font-size:clamp(28px,5vw,56px);margin:0 0 8px;}
  .subtitle{color:var(--muted);margin:0 0 18px;font-size:clamp(14px,2.2vw,18px);}
  .badges{display:flex;flex-wrap:wrap;gap:10px;justify-content:center;margin-bottom:10px;}
  .badge-img img{height:30px;display:block;}
  .row{display:flex;flex-wrap:wrap;gap:10px;justify-content:center;margin-top:8px;}
  .pill{display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border-radius:999px;border:1px solid var(--border);font-weight:800;text-decoration:none;color:#fff;box-shadow:0 6px 20px rgba(0,0,0,.25);}
  .ln{background:linear-gradient(135deg,#0A66C2,#2E8AE6);}
  .gh{background:linear-gradient(135deg,#111,#2a2a2a);}
  .kg{background:linear-gradient(135deg,#20BEFF,#55D0FF);color:#05344a;}
  .cv{background:linear-gradient(135deg,#0F766E,#34D399);}
  .acv{background:linear-gradient(135deg,#2563EB,#60A5FA);}
  .slides{background:linear-gradient(135deg,#7C3AED,#A78BFA);}
  .pptx{background:linear-gradient(135deg,#D35230,#E07B5D);}
  .scroll-cue{position:absolute;bottom:16px;left:50%;transform:translateX(-50%);color:var(--muted);font-size:12px;opacity:.9;}

  /* Vertical snapping for main sections */
  main{scroll-snap-type:y mandatory;}

  /* SHOWCASE (horizontal circular scroller) */
  .showcase{min-height:100svh;display:grid;place-items:center;padding:0;border-bottom:1px solid var(--border);scroll-snap-align:start;scroll-snap-stop:always;background:
    radial-gradient(900px 600px at 10% 20%, rgba(96,165,250,.25), transparent 60%),
    radial-gradient(900px 600px at 80% 85%, rgba(124,58,237,.25), transparent 60%);
  }
  .hshell{width:100%;height:100%;display:grid;place-items:center;padding:0 var(--peek);position:relative;}
  .rail{
    display:flex;gap:var(--snap-gap);align-items:center;
    width:100%;height:auto;
    overflow-x:auto;overflow-y:hidden;scrollbar-width:none;-ms-overflow-style:none;
    scroll-snap-type:x mandatory;scroll-padding-inline:var(--peek);
    overscroll-behavior-x: contain;-webkit-overflow-scrolling: touch;
    padding: 8vh 0;
  }
  .rail::-webkit-scrollbar{display:none;}

  .hcard{
    flex:0 0 auto;
    width: clamp(320px, 70vw, 950px);
    aspect-ratio: 16/9;
    border-radius:18px;border:1px solid var(--border);
    background:var(--panel);position:relative;overflow:hidden;
    scroll-snap-align:center;scroll-snap-stop:always;
    text-decoration:none;color:inherit;
    transform: scale(var(--side-scale));
    opacity:.85;
    box-shadow:0 10px 24px rgba(0,0,0,.30), 0 0 0 1px rgba(255,255,255,.03) inset;
    transition: transform .28s ease, opacity .28s ease, box-shadow .28s ease, filter .28s ease;
    will-change: transform;
  }
  .hcard img{position:absolute;inset:0;width:100%;height:100%;object-fit:cover;filter:brightness(.9);user-select:none;-webkit-user-drag:none;}
  .hcard.is-center{
    transform: scale(var(--center-scale));
    opacity:1;z-index:2;
    box-shadow:0 16px 42px rgba(0,0,0,.45), 0 0 0 1px rgba(255,255,255,.05) inset;
  }

  .hint{
    position:absolute;top:50%;transform:translateY(-50%);
    width:44px;height:44px;display:grid;place-items:center;
    border-radius:999px;border:1px solid var(--border);background:rgba(0,0,0,.35);color:#fff;cursor:pointer;opacity:.85;
  }
  .hint:hover{opacity:1;}
  .left-hint{left:12px;}
  .right-hint{right:12px;}

  /* Generic vertical sections */
  section.block{min-height:100svh;display:grid;place-items:center;scroll-snap-align:start;scroll-snap-stop:always;padding:24px;}
  .panel{max-width:1100px;width:100%;min-height:70svh;border:1px solid var(--border);border-radius:16px;background:var(--panel);padding:24px;box-shadow:0 10px 30px rgba(0,0,0,.35), 0 0 0 1px rgba(255,255,255,.03) inset;}
  .grid{display:grid;gap:14px;}
  @media(min-width:850px){.grid{grid-template-columns:repeat(2,1fr);}}
  .card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:14px;}
  .card h3{margin:0 0 6px;font-size:16px;}
  .card p{margin:0;color:var(--muted);font-size:14px;}
  .btn{display:inline-block;margin-top:8px;padding:8px 10px;border:1px solid var(--border);border-radius:8px;text-decoration:none;color:var(--text);background:#0f172a22;}

  footer{text-align:center;color:var(--muted);font-size:13px;padding:28px 16px 40px;}
</style>
</head>
<body>

<header>
  <nav class="nav">
    <div class="brand">Mahdi Tavakol</div>
    <div class="spacer"></div>
    <a href="#showcase">Showcase</a>
    <a href="#repos">Projects</a>
    <a href="#aboutme">About</a>
    <a href="#contact">Contact</a>
  </nav>
</header>

<!-- ===== HERO (Google Drive with auto-fallback to preview iframe) ===== -->
<section class="hero" id="home" aria-label="hero">
  <div class="media-layer">
    <div style="position:relative; width:100%; height:100%; overflow:hidden;">
      <iframe
        src="https://player.vimeo.com/video/1131788634?autoplay=1&muted=1&loop=1&background=1"
        style="position:absolute; top:0; left:0; width:100%; height:100%; border:none;"
        allow="autoplay; fullscreen; picture-in-picture"
        referrerpolicy="strict-origin-when-cross-origin"
        title="invideo-ai-1080 The Lead Dev: C_C++ Duo in 65 Seconds"
        loading="lazy">
      </iframe>
    </div>
  </div>
</section>
  </div>

  <div class="overlay" aria-hidden="true"></div>

  <div class="hero-inner">
    <div>
      <h1 class="title">🧭 Mahdi Tavakol — C++ • Python • Software Engineering Portfolio</h1>
      <p class="subtitle"><strong>Modern C • C++ • CUDA • RAII • Parallelism • Numerical Algorithms • Linux Toolchains • Data Science</strong></p>

      <!-- Tech stack badges (C++ → C → Python → …) -->
      <div class="badges">
        <a href="https://en.cppreference.com/w/" target="_blank" class="badge-img"><img alt="C++" src="https://img.shields.io/badge/C%2B%2B-17%2F20-00599C?logo=c%2B%2B&logoColor=white&style=for-the-badge"></a>
        <a href="https://www.open-std.org/jtc1/sc22/wg14/" target="_blank" class="badge-img"><img alt="C" src="https://img.shields.io/badge/C-ISO%20C-555555?logo=c&logoColor=white&style=for-the-badge"></a>
        <a href="https://www.python.org/" target="_blank" class="badge-img"><img alt="Python" src="https://img.shields.io/badge/Python-3.x-3776AB?logo=python&logoColor=white&style=for-the-badge"></a>
        <a href="https://eigen.tuxfamily.org/" target="_blank" class="badge-img"><img alt="Eigen" src="https://img.shields.io/badge/Eigen-Linear%20Algebra-7E57C2?style=for-the-badge"></a>
        <a href="https://www.openmp.org/" target="_blank" class="badge-img"><img alt="OpenMP" src="https://img.shields.io/badge/OpenMP-Parallelism-1E88E5?style=for-the-badge"></a>
        <a href="https://www.mpi-forum.org/" target="_blank" class="badge-img"><img alt="MPI" src="https://img.shields.io/badge/MPI-Distributed-00838F?style=for-the-badge"></a>
        <a href="https://developer.nvidia.com/cuda-zone" target="_blank" class="badge-img"><img alt="CUDA" src="https://img.shields.io/badge/CUDA-GPU%20Computing-76B900?logo=nvidia&logoColor=white&style=for-the-badge"></a>
        <a href="https://cmake.org/" target="_blank" class="badge-img"><img alt="CMake" src="https://img.shields.io/badge/CMake-Build-064F8C?logo=cmake&style=for-the-badge"></a>
        <a href="https://www.kernel.org/linux.html" target="_blank" class="badge-img"><img alt="Linux" src="https://img.shields.io/badge/Linux-Dev%20Env-242938?logo=linux&logoColor=white&style=for-the-badge"></a>
      </div>

      <div class="row">
        <a class="pill ln" href="https://www.linkedin.com/in/mahditavakol/" target="_blank">LinkedIn</a>
        <a class="pill gh" href="https://github.com/MahdiTavakol" target="_blank">GitHub</a>
        <a class="pill kg" href="https://www.kaggle.com/mahditavakol/code" target="_blank">Kaggle</a>
      </div>

      <div class="row" style="margin-top:12px">
        <a class="pill cv" href="CV.pdf" target="_blank">Professional CV</a>
        <a class="pill acv" href="CV-academic.pdf" target="_blank">Academic CV</a>
        <a class="pill slides" href="C++-Overview.pdf" target="_blank">Portfolio Slides (PDF)</a>
        <a class="pill pptx" href="C++-Overview.pptx" target="_blank">Portfolio Slides (PPTX)</a>
      </div>
    </div>
  </div>

  <div class="scroll-cue">Scroll ↓</div>
</section>

<main>
  <!-- ===== SECTION 2: SHOWCASE (Horizontal circular snap + zoom center) ===== -->
  <section class="showcase" id="showcase" aria-label="showcase">
    <div class="hshell">
      <button class="hint left-hint" id="leftBtn" aria-label="Scroll left">←</button>
      <button class="hint right-hint" id="rightBtn" aria-label="Scroll right">→</button>

      <div class="rail" id="rail" aria-label="carousel">
        <!-- Content is populated by JS (originals + clones for circular loop) -->
      </div>
    </div>
  </section>

  <!-- ===== Projects ===== -->
  <section class="block" id="repos" aria-label="projects">
    <div class="panel">
      <h2>🗂 Featured Repositories</h2>
      <div class="grid">
        <div class="card">
          <h3>🌀 ModernCppProjects</h3>
          <p>C++ projects demonstrating architecture, parallelism, and performance (e.g., Mandelbrot renderer).</p>
          <a class="btn" href="https://github.com/MahdiTavakol/ModernCppProjects" target="_blank">View repository</a>
        </div>
        <div class="card">
          <h3>🧪 LAMMPS-Constant-pH</h3>
          <p>C++ extensions for constant-pH MD with robust HPC integration.</p>
          <a class="btn" href="https://github.com/MahdiTavakol/LAMMPS-Constant-pH" target="_blank">View repository</a>
        </div>
        <div class="card">
          <h3>⛰️ MetaDynamics / TI</h3>
          <p>Adaptive biasing and thermodynamic integration methods.</p>
          <a class="btn" href="https://github.com/MahdiTavakol/lammps-metaAR-10Sep2025" target="_blank">View repository</a>
        </div>
        <div class="card">
          <h3>🧠 NeuralNetwork (C++)</h3>
          <p>Eigen-powered neural network with RAII and OpenMP/MPI acceleration.</p>
          <a class="btn" href="https://github.com/MahdiTavakol/ModernCppProjects/tree/master/NeuralNetwork/NeuralNetwork" target="_blank">View subfolder</a>
        </div>
      </div>
    </div>
  </section>

  <!-- ===== About ===== -->
  <section class="block" id="aboutme" aria-label="about-me">
    <div class="panel">
      <h2>📄 About me</h2>
      <p>I build high-performance numerical and simulation software in C and C++. My work focuses on RAII, parallelism (OpenMP/MPI/CUDA), and clean build systems; I also publish Python notebooks for data analysis.</p>
      <div class="row" style="margin-top:12px">
        <a class="pill cv" href="CV.pdf" target="_blank">Professional CV</a>
        <a class="pill acv" href="CV-academic.pdf" target="_blank">Academic CV</a>
        <a class="pill slides" href="C++-Overview.pdf" target="_blank">Portfolio Slides (PDF)</a>
        <a class="pill pptx" href="C++-Overview.pptx" target="_blank">Portfolio Slides (PPTX)</a>
      </div>
    </div>
  </section>

  <!-- ===== Contact ===== -->
  <section class="block" id="contact" aria-label="contact">
    <div class="panel">
      <h2>🗣️ Contact</h2>
      <p><strong>Mahdi Tavakol</strong> — Postdoctoral Researcher • Computational Scientist</p>
      <p>Email: mahditavakol90 [at] gmail [dot] com</p>
    </div>
  </section>
</main>

<footer>
  © <span id="year"></span> Mahdi Tavakol •
  <a href="https://github.com/MahdiTavakol" target="_blank" style="color:inherit">GitHub</a> •
  <a href="https://www.linkedin.com/in/mahditavakol/" target="_blank" style="color:inherit">LinkedIn</a>
</footer>

<script>
  // Respect reduced motion
  const vid = document.getElementById('bgvid');
  const drivePreview = document.getElementById('drivePreview');
  if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) { vid && vid.pause(); }

  // Try raw Drive video for 3s; if it doesn't begin loading, swap to preview iframe
  (function ensureVideoPlays(){
    if (!vid) return;
    let switched = false;
    const switchToPreview = () => {
      if (switched) return;
      switched = true;
      if (vid) { vid.parentElement.removeChild(vid); }
      drivePreview.style.display = 'block';
      // Some browsers require re-setting src to start playback immediately
      const src = drivePreview.src;
      drivePreview.src = src;
    };

    // If metadata or canplay arrives, we're good
    const ok = () => { switched = true; };
    vid.addEventListener('loadeddata', ok, {once:true});
    vid.addEventListener('canplay', ok, {once:true});
    vid.addEventListener('playing', ok, {once:true});

    // On error or stall -> fallback
    vid.addEventListener('error', switchToPreview, {once:true});
    setTimeout(()=>{ if (!switched) switchToPreview(); }, 3000);
  })();

  // Auto-advance from HERO to Showcase on first downward wheel
  (function(){
    const hero = document.getElementById('home');
    const next = document.getElementById('showcase');
    if(!hero || !next) return;
    let fired = false;

    const goNext = ()=>{
      if (fired) return; fired = true;
      next.scrollIntoView({behavior:'smooth'});
      setTimeout(()=>{ window.centerShowcaseFirst?.(); fired = false; }, 700);
    };

    hero.addEventListener('wheel',(e)=>{
      if(e.deltaY>12){ e.preventDefault(); goNext(); }
    }, {passive:false});
  })();

  // ===== Horizontal circular rail with zoomed center =====
  (function(){
    const rail = document.getElementById('rail');
    const leftBtn = document.getElementById('leftBtn');
    const rightBtn = document.getElementById('rightBtn');
    const showcase = document.getElementById('showcase');
    if(!rail || !showcase) return;

    // 1) Define your slides HERE
    const slidesData = [
      { href: 'C++-Overview.pdf', title: 'Portfolio Slides (PDF)', img: 'https://images.unsplash.com/photo-1518770660439-4636190af475?q=80&w=1600&auto=format&fit=crop' },
      { href: 'https://github.com/MahdiTavakol/ModernCppProjects', title: 'Modern C++ Projects', img: 'https://images.unsplash.com/photo-1558494949-ef010cbdcc31?q=80&w=1600&auto=format&fit=crop' },
      { href: 'https://github.com/MahdiTavakol/LAMMPS-Constant-pH', title: 'LAMMPS Constant-pH', img: 'https://images.unsplash.com/photo-1605379399642-870262d3d051?q=80&w=1600&auto=format&fit=crop' },
      { href: 'https://www.kaggle.com/mahditavakol/code', title: 'Kaggle Notebooks', img: 'https://images.unsplash.com/photo-1550645612-83f2d0f9b1f4?q=80&w=1600&auto=format&fit=crop' },
      { href: 'C++-Overview.pptx', title: 'Portfolio Slides (PPTX)', img: 'https://images.unsplash.com/photo-1518779578993-ec3579fee39f?q=80&w=1600&auto=format&fit=crop' },
    ];

    // 2) Build circular content: prefix clones + originals + suffix clones
    rail.innerHTML = '';
    const originals = slidesData.map(makeCard);
    const prefix = slidesData.map(makeCard);      // clones before
    const suffix = slidesData.map(makeCard);      // clones after

    prefix.forEach(n => { n.dataset.clone = 'prefix'; rail.appendChild(n); });
    originals.forEach(n => { n.dataset.clone = 'orig'; rail.appendChild(n); });
    suffix.forEach(n => { n.dataset.clone = 'suffix'; rail.appendChild(n); });

    function makeCard(d, i){
      const a = document.createElement('a');
      a.className = 'hcard';
      a.href = d.href;
      a.target = '_blank';
      a.title = d.title;
      const img = document.createElement('img');
      img.alt = d.title;
      img.src = d.img;
      a.appendChild(img);
      a.dataset.idx = i; // original logical index
      return a;
    }

    // Helper lists for later
    const allCards = Array.from(rail.querySelectorAll('.hcard'));
    const origCards = allCards.filter(n => n.dataset.clone === 'orig');

    // 3) Center helpers
    function centerCard(node, behavior='smooth'){
      const target = node.offsetLeft + node.offsetWidth/2 - rail.clientWidth/2;
      rail.scrollTo({ left: target, behavior });
      setTimeout(markCenter, behavior === 'smooth' ? 250 : 0);
    }
    function markCenter(){
      const rc = rail.getBoundingClientRect();
      const cx = rc.left + rc.width/2;
      let best=null, bestDist=Infinity;
      allCards.forEach(c=>{
        const r = c.getBoundingClientRect();
        const d = Math.abs(r.left + r.width/2 - cx);
        if(d < bestDist){ bestDist=d; best=c; }
      });
      allCards.forEach(c => c.classList.toggle('is-center', c===best));
    }

    // 4) Start centered on the first ORIGINAL card
    function centerFirstOriginal(behavior='smooth'){
      if(!origCards.length) return;
      centerCard(origCards[0], behavior);
    }
    window.centerShowcaseFirst = ()=> centerFirstOriginal('smooth');

    // 5) Keep it circular: normalize when we drift into prefix/suffix
    function normalizeIfOutOfBounds(){
      const rc = rail.getBoundingClientRect();
      const cx = rc.left + rc.width/2;
      let best=null, bestDist=Infinity;
      allCards.forEach(c=>{
        const r = c.getBoundingClientRect();
        const d = Math.abs(r.left + r.width/2 - cx);
        if(d<bestDist){ bestDist=d; best=c; }
      });
      if(!best) return;

      const isPrefix = best.dataset.clone === 'prefix';
      const isSuffix = best.dataset.clone === 'suffix';
      if (isPrefix || isSuffix) {
        const logical = parseInt(best.dataset.idx, 10);
        const target = origCards[logical];
        if (target) {
          const left = target.offsetLeft + target.offsetWidth/2 - rail.clientWidth/2;
          rail.scrollTo({ left, behavior: 'instant' });
          setTimeout(markCenter, 0);
        }
      }
    }

    // 6) Wheel converts vertical to horizontal
    rail.addEventListener('wheel', (e)=>{
      if(Math.abs(e.deltaY) > Math.abs(e.deltaX)){
        e.preventDefault();
        rail.scrollLeft += e.deltaY;
      }
    }, {passive:false});

    // 7) Drag-to-scroll with momentum
    let down=false, sx=0, sl=0, vel=0, raf=null, lx=0, lt=0;
    const stop=()=>{ if(raf){ cancelAnimationFrame(raf); raf=null; } };
    const momentum=()=>{ rail.scrollLeft -= vel; vel*=0.95; if(Math.abs(vel)>0.3){ raf=requestAnimationFrame(momentum); } else { normalizeIfOutOfBounds(); markCenter(); } };

    rail.addEventListener('mousedown', (e)=>{
      down=true; sx=e.pageX; sl=rail.scrollLeft; stop(); lx=sx; lt=performance.now();
      rail.style.cursor='grabbing';
    });
    window.addEventListener('mousemove', (e)=>{
      if(!down) return;
      const now=performance.now();
      const dx=e.pageX - sx;
      rail.scrollLeft = sl - dx;
      vel = (e.pageX - lx)/(now - lt) * 16;
      lx=e.pageX; lt=now;
      markCenter();
    });
    window.addEventListener('mouseup', ()=>{
      if(!down) return; down=false; rail.style.cursor='grab'; stop(); momentum();
    });

    // Touch
    rail.addEventListener('touchstart', (e)=>{
      down=true; sx=e.touches[0].pageX; sl=rail.scrollLeft; stop(); lx=sx; lt=performance.now();
    }, {passive:true});
    rail.addEventListener('touchmove', (e)=>{
      if(!down) return;
      const now=performance.now();
      const dx=e.touches[0].pageX - sx;
      rail.scrollLeft = sl - dx;
      vel = (e.touches[0].pageX - lx)/(now - lt) * 16;
      lx=e.touches[0].pageX; lt=now;
      markCenter();
    }, {passive:true});
    rail.addEventListener('touchend', ()=>{
      if(!down) return; down=false; stop(); momentum();
    });

    // 8) Arrow buttons wrap circularly by logical index
    function currentLogicalIndex(){
      const rc = rail.getBoundingClientRect(); const cx = rc.left + rc.width/2;
      let best=null, bestDist=Infinity;
      allCards.forEach(c=>{
        const r = c.getBoundingClientRect();
        const d = Math.abs(r.left + r.width/2 - cx);
        if(d<bestDist){ bestDist=d; best=c; }
      });
      return best ? parseInt(best.dataset.idx,10) : 0;
    }
    function centerLogical(idx, behavior='smooth'){
      const n = origCards.length;
      const safe = (idx % n + n) % n;
      const target = origCards[safe];
      if (target) centerCard(target, behavior);
    }
    leftBtn.addEventListener('click', ()=>{ centerLogical(currentLogicalIndex()-1, 'smooth'); });
    rightBtn.addEventListener('click', ()=>{ centerLogical(currentLogicalIndex()+1, 'smooth'); });

    // 9) Maintain center highlight; normalize on scroll
    let ticking=false;
    rail.addEventListener('scroll', ()=>{
      if(!ticking){
        requestAnimationFrame(()=>{
          normalizeIfOutOfBounds();
          markCenter();
          ticking=false;
        });
        ticking=true;
      }
    });

    // 10) Initial center after images decode
    const imgs = Array.from(rail.querySelectorAll('img'));
    Promise.allSettled(imgs.map(img => (img.decode ? img.decode() : Promise.resolve())))
      .finally(()=>{ centerFirstOriginal('instant'); });

    // Also center when showcase first becomes visible
    let centeredOnEnter = false;
    new IntersectionObserver((entries)=>{
      entries.forEach(e=>{
        if(e.isIntersecting && !centeredOnEnter){
          centeredOnEnter = true;
          centerFirstOriginal('smooth');
        }
      });
    }, { root: null, threshold: 0.6 }).observe(showcase);
  })();

  // Year in footer
  document.getElementById('year').textContent = new Date().getFullYear();
</script>
</body>
</html>
